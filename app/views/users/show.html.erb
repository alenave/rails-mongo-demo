

<%= javascript_tag do %>
window.max_loan = <%= @max_loan %>;
window.min_loan = <%= @min_loan %>;
window.max_tenure = <%= @max_tenure %>;
window.min_tenure = <%= @min_tenure %>;
<% end %>

<table width="90%" cellpadding="50" bgcolor="155d84">
  <tr>
    <th colspan="3" style="color:white; font-size:18px; padding-bottom:1px;">Select Loan Amount</th>
    <th colspan="3" style="color:white; font-size:18px; padding-bottom:1px;">Select Tenure</th>
  </tr>
  <tr>
  
  <td width="35%" style="
    padding-bottom: 1px;" bgcolor="#155d84" colspan="3">
    <div id="slider-range-max"></div>
    </td>
    
    <td width="35%" style="
    padding-bottom: 1px;" bgcolor="#155d84" colspan="3">
    <div id="slider-range-max-min"></div>
    </td>
  </tr>
  <tr>
  <td bgcolor="#155d84" width="5%" style="text-align:left; vertical-align:top; padding-top:0; color:white ">
  <%= @min_loan %>
  </td>
    <td style="text-align:center;" bgcolor="#155d84" width="30%" >
      <p>
  <input type="text" id="amount" readonly style="border:0; color:#155d84; font-weight:bold;  font-size:20px; padding:20px; padding-left:150px;">
</p>
    </td>
    <td bgcolor="#155d84" width="5%" style="text-align:right; vertical-align:top; padding-top:0; color:white "> 
  <%= @max_loan %>
  </td>
  <td bgcolor="#155d84" width="5%" style="text-align:left; vertical-align:top; padding-top:0; color:white ">
  <%= @min_tenure %>
  </td>
    <td style="text-align:center;" bgcolor="#155d84" width="30%"> 
        <p>
  <input type="text" id="amount_" readonly style="border:0; color:#155d84; font-weight:bold;  font-size:20px; padding:20px; padding-left:150px;" >
  </td>
    <td bgcolor="#155d84" width="5%" style="text-align:right; vertical-align:top; padding-top:0; color:white "> 
  <%= @max_tenure %>
  </td>
</p> 
    </td>
  </tr>
</table>

<%= hidden_field_tag :task_id, @display_details%>


<table cellpadding="10">
  <tr>
    <th>Bank</th>
    <th>Interest Rate</th>
    <th>Charges</th>
    <th>Emi</th>
  </tr>

<% details = '<%= javascript_tag  do %> $("#task_id").val(); <% end %>' %>
  
  <% details.each do |display_detail| %>
   <tr>
      <td>
     <%= image_tag "data:image/jpeg;base64,#{display_detail['bank_logo']}" %>
  </td>
      <td><%= display_detail["interest_rate"].round(2)%></td>
      <td><%= display_detail["processing_amount"] %></td>
      <td><%= display_detail["emi"].round(2) %></td>
    </tr>
    <% end %>
  </table>
  
 
 <script>
  $(function() {
  
    $( "#slider-range-max" ).slider({
      range: "min",
      min: window.min_loan,
      max: window.max_loan,
      value: (window.min_loan + window.max_loan )/2,
      slide: function( event, ui ) {
        $( "#amount" ).val( ui.value );
      }

    });
    $( "#amount" ).val( $( "#slider-range-max" ).slider( "value" ) );
    $("#slider-range-max").on("slidestop", function(event, ui) {
        alert("Im done");
        var data = {"loan_amount": ui.value} 
        $.ajax({
          type: 'POST',
          url: 'show.json',
          data: data,
          dataType: "json",
          success: function(data) {
              $("#task_id").val()
          }

        });
    });
  });
  </script>



<div id="slider-range-max-min"></div>
 
 <script>
  $(function() {
  
    $( "#slider-range-max-min" ).slider({
      range: "min",
      min: window.min_tenure,
      max: window.max_tenure,
      value: (window.min_tenure + window.max_tenure )/2,
      slide: function( event, ui ) {
        $( "#amount_" ).val( ui.value );
      }
    });
    $( "#amount_" ).val( $( "#slider-range-max-min" ).slider( "value" ) );
  });
  </script>